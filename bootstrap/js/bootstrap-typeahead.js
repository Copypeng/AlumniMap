!function(a){var b=function(d,c){this.$element=a(d);this.options=a.extend({},a.fn.typeahead.defaults,c);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.$menu=a(this.options.menu).appendTo("body");this.source=this.options.source;this.onselect=this.options.onselect;this.strings=true;this.shown=false;this.listen();};b.prototype={constructor:b,select:function(){var d=JSON.parse(this.$menu.find(".active").attr("data-value")),c;if(!this.strings){c=d[this.options.property];}else{c=d;}this.$element.val(c);if(typeof this.onselect=="function"){this.onselect(d);}return this.hide();},show:function(){var c=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:c.top+c.height,left:c.left});this.$menu.show();this.shown=true;return this;},hide:function(){this.$menu.hide();this.shown=false;return this;},lookup:function(e){var d=this,c,g,f;this.query=this.$element.val();if(typeof this.source=="function"){f=this.source(this,this.query);if(f){this.process(f);}}else{this.process(this.source);}},process:function(d){var e=this,c,f;if(d.length&&typeof d[0]!="string"){this.strings=false;}this.query=this.$element.val();if(!this.query){return this.shown?this.hide():this;}c=a.grep(d,function(g){if(!e.strings){g=g[e.options.property];}if(e.matcher(g)){return g;}});c=this.sorter(c);if(!c.length){return this.shown?this.hide():this;}return this.render(c.slice(0,this.options.items)).show();},matcher:function(c){return ~c.toLowerCase().indexOf(this.query.toLowerCase());},sorter:function(e){var f=[],d=[],c=[],g,h;while(g=e.shift()){if(this.strings){h=g;}else{h=g[this.options.property];}if(!h.toLowerCase().indexOf(this.query.toLowerCase())){f.push(g);}else{if(~h.indexOf(this.query)){d.push(g);}else{c.push(g);}}}return f.concat(d,c);},highlighter:function(c){return c.replace(new RegExp("("+this.query+")","ig"),function(d,e){return"<strong>"+e+"</strong>";});},render:function(c){var d=this;c=a(c).map(function(e,f){e=a(d.options.item).attr("data-value",JSON.stringify(f));if(!d.strings){f=f[d.options.property];}e.find("a").html(d.highlighter(f));return e[0];});c.first().addClass("active");this.$menu.html(c);return this;},next:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.next();if(!c.length){c=a(this.$menu.find("li")[0]);}c.addClass("active");},prev:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.prev();if(!c.length){c=this.$menu.find("li").last();}c.addClass("active");},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this));if(a.browser.webkit||a.browser.msie){this.$element.on("keydown",a.proxy(this.keypress,this));}this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this));},keyup:function(c){c.stopPropagation();c.preventDefault();switch(c.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown){return;}this.select();break;case 27:this.hide();break;default:this.lookup();}},keypress:function(c){c.stopPropagation();if(!this.shown){return;}switch(c.keyCode){case 9:case 13:case 27:c.preventDefault();break;case 38:c.preventDefault();this.prev();break;case 40:c.preventDefault();this.next();break;}},blur:function(d){var c=this;d.stopPropagation();d.preventDefault();setTimeout(function(){c.hide();},150);},click:function(c){c.stopPropagation();c.preventDefault();this.select();},mouseenter:function(c){this.$menu.find(".active").removeClass("active");a(c.currentTarget).addClass("active");}};a.fn.typeahead=function(c){return this.each(function(){var f=a(this),e=f.data("typeahead"),d=typeof c=="object"&&c;if(!e){f.data("typeahead",(e=new b(this,d)));}if(typeof c=="string"){e[c]();}});};a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li data-id="1"><a href="#"></a></li>',onselect:null,property:"value"};a.fn.typeahead.Constructor=b;a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(d){var c=a(this);if(c.data("typeahead")){return;}d.preventDefault();c.typeahead(c.data());});});}(window.jQuery);